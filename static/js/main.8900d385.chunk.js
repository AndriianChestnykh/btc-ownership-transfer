(window["webpackJsonpbtc-ownership-transfer"]=window["webpackJsonpbtc-ownership-transfer"]||[]).push([[0],{111:function(e,t,n){"use strict";(function(e){var a=n(14),r=n(15),i=n(17),s=n(16),o=n(9),c=n(18),d=n(0),u=n.n(d),l=n(7),m=n(3),p=function(t){function n(e){var t;return Object(a.a)(this,n),(t=Object(i.a)(this,Object(s.a)(n).call(this,e))).getActionButtons=t.getActionButtons.bind(Object(o.a)(t)),t.addTxWrapper=t.addTxWrapper.bind(Object(o.a)(t)),t.sendToOwnerWrapper=t.sendToOwnerWrapper.bind(Object(o.a)(t)),t.sendToHeirWrapper=t.sendToHeirWrapper.bind(Object(o.a)(t)),t}return Object(c.a)(n,t),Object(r.a)(n,[{key:"getActionButtons",value:function(e){var t={addTx:u.a.createElement("button",{onClick:this.addTxWrapper},"Sign intermediate tx"),sendToOwner:u.a.createElement("button",{onClick:this.sendToOwnerWrapper},"Widthraw to owner"),sendToHeir:u.a.createElement("button",{onClick:this.sendToHeirWrapper},"Widthraw to heir")};return Object.keys(e).map((function(e,n){return t[e]?u.a.createElement("div",{key:n},t[e]):""}))}},{key:"addTxWrapper",value:function(){var e=m.a.network,t=l.e({childOwner:l.b(m.a.owner.mnemonic,m.a.owner.derivationPath,e).child,childHeir:l.b(m.a.heir.mnemonic,m.a.heir.derivationPath,e).child,txid:this.props.utxo.transaction_hash,output:this.props.utxo.index,amount:this.props.utxo.value,fee:m.a.fee,sequenceFeed:m.a.sequenceFeed,network:e});this.props.actions.addTx(t)}},{key:"sendToOwnerWrapper",value:function(){var t=m.a.network,n=l.b(m.a.owner.mnemonic,m.a.owner.derivationPath,t),a=n.child,r=n.address,i=l.d({childPerson:a,redeemScript:e.from(this.props.redeem,"hex"),txid:this.props.utxo.transaction_hash,output:this.props.utxo.index,amount:this.props.utxo.value,fee:m.a.fee,network:t});l.a(i.toHex()),this.props.actions.sendToOwner(r)}},{key:"sendToHeirWrapper",value:function(){var t=m.a.network,n=l.b(m.a.heir.mnemonic,m.a.heir.derivationPath,t),a=n.child,r=n.address,i=l.c({childPerson:a,redeemScript:e.from(this.props.redeem,"hex"),txid:this.props.utxo.transaction_hash,output:this.props.utxo.index,amount:this.props.utxo.value,fee:m.a.fee,sequenceFeed:m.a.sequenceFeed,network:t});l.a(i.toHex()),this.props.actions.sendToHeir(r)}},{key:"render",value:function(){return u.a.createElement("div",{style:{wordWrap:"break-word"}},u.a.createElement("p",null,u.a.createElement("strong",null,"UTXO ",this.props.index+1)),u.a.createElement("span",null,"Tx hash: ",this.props.utxo.transaction_hash),u.a.createElement("br",null),u.a.createElement("span",null,"Index: ",this.props.utxo.index),u.a.createElement("br",null),u.a.createElement("span",null,"Value: ",this.props.utxo.value/Math.pow(10,8)+" BTC"),u.a.createElement("br",null),u.a.createElement("span",null,"Block: ",this.props.utxo.block_id),u.a.createElement("br",null),u.a.createElement("br",null),this.getActionButtons(this.props.actions),u.a.createElement("br",null),u.a.createElement("br",null))}}]),n}(u.a.Component);t.a=p}).call(this,n(1).Buffer)},113:function(e,t,n){e.exports=n(248)},124:function(e,t){},126:function(e,t){},144:function(e,t){},147:function(e,t){},248:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(110),s=n.n(i),o=(n(118),n(46)),c=n(14),d=n(15),u=n(17),l=n(16),m=n(9),p=n(18),h=n(33),v=n.n(h),b=n(44),f=n(111),x=n(45),k=n.n(x),w=n(3),E=n(7),O=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={utxos:[]},n}return Object(p.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.updateUTXOList(this.props.address)}},{key:"updateUTXOList",value:function(){var e=Object(b.a)(v.a.mark((function e(t){var n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E.f(this.props.address).isValid){e.next=2;break}return e.abrupt("return");case 2:return n="".concat(w.a.apiURIs.address,"/").concat(t),e.next=5,k.a.get(n).catch((function(e){return alert("Blockchain API request error: "+e)}));case 5:a=e.sent,this.setState({utxos:a.data.data[t].utxo});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllUtxo",value:function(){var e=this,t=this.state.utxos;return t&&t.length?t.map((function(t,n){return r.a.createElement(f.a,{key:n,index:n,utxo:t,redeem:e.props.redeem,actions:e.props.actions})})):r.a.createElement("div",null,"Empty...")}},{key:"getHeader",value:function(){var e=E.f(this.props.address);return e.isValid?r.a.createElement("div",{style:{wordWrap:"break-word"}},r.a.createElement("h4",null,this.props.address),r.a.createElement("p",null,"Redeem: ",this.props.redeem),r.a.createElement("br",null)):r.a.createElement("h4",null,"Address is not valid: ",e.message)}},{key:"render",value:function(){return r.a.createElement("div",{className:"content"},this.getHeader(),this.getAllUtxo())}}]),t}(r.a.Component),y=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.person,n=e.mnemonic,a=e.updateMnemonic,i=w.a[t],s=i.derivationPath,o=i.name,c=w.a.network,d=Object(E.b)(n,s,c).address;return r.a.createElement("div",{className:"ui card"},r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"header"},o)),r.a.createElement("div",{className:"content"},r.a.createElement("form",null,r.a.createElement("label",{htmlFor:"mnemonic"}),r.a.createElement("br",null),r.a.createElement("textarea",{id:"mnemonic",name:"mnemonic",cols:"30",rows:"3",onChange:function(e){return a(t,e.target.value)},defaultValue:n})),r.a.createElement("p",null,"Derivation path: ",s)),r.a.createElement("div",{className:"content"},r.a.createElement(O,{address:d,actions:this.props.actions})))}}]),t}(r.a.Component),g=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).broadcast=n.broadcast.bind(Object(m.a)(n)),n}return Object(p.a)(t,e),Object(d.a)(t,[{key:"broadcast",value:function(){E.a(this.props.tx.raw),this.props.removeTx(this.props.tx.id),this.props.addIntermediate({address:this.props.tx.address,redeem:this.props.tx.redeem})}},{key:"render",value:function(){return r.a.createElement("div",{className:"content",style:{wordWrap:"break-word"}},r.a.createElement("h4",null,"Txid: ",this.props.tx.id),r.a.createElement("p",null,this.props.tx.raw),r.a.createElement("p",null,r.a.createElement("button",{onClick:this.broadcast},"Broadcast")))}}]),t}(r.a.Component);var j=function(e){return r.a.createElement("div",{className:"ui card"},r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"header"},"Transactions")),e.txs.map((function(t,n){return r.a.createElement(g,{key:n,tx:t,removeTx:e.removeTx,addIntermediate:e.addIntermediate})})))},T=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(d.a)(t,[{key:"getAddressUtxoLists",value:function(){var e=this;return this.props.addressesData.map((function(t,n){return r.a.createElement(O,{key:n,address:t.address,redeem:t.redeem,actions:e.props.actions})}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"ui card"},r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"header"},"Intermediate addresses")),this.getAddressUtxoLists())}}]),t}(r.a.Component),S=function(e){function t(e){var n;Object(c.a)(this,t);var a=(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).getStorage();return n.state={owner:{mnemonic:w.a.owner.mnemonic},heir:{mnemonic:w.a.heir.mnemonic},intermediate:a.intermediate,txs:a.txs},n.updateMnemonic=n.updateMnemonic.bind(Object(m.a)(n)),n.addTx=n.addTx.bind(Object(m.a)(n)),n.removeTx=n.removeTx.bind(Object(m.a)(n)),n.addIntermediate=n.addIntermediate.bind(Object(m.a)(n)),n.removeIntermediate=n.removeIntermediate.bind(Object(m.a)(n)),n}return Object(p.a)(t,e),Object(d.a)(t,[{key:"getStorageKey",value:function(){var e=w.a.owner,t=w.a.heir,n=w.a.network,a=Object(E.b)(e.mnemonic,e.derivationPath,n).address,r=Object(E.b)(t.mnemonic,t.derivationPath,n).address;return"".concat(a,"_").concat(r)}},{key:"getStorage",value:function(){var e=JSON.parse(localStorage.getItem(this.getStorageKey()));return{intermediate:e?e.intermediate:[],txs:e?e.txs:[]}}},{key:"setStorage",value:function(e){localStorage.setItem(this.getStorageKey(),JSON.stringify(e))}},{key:"updateMnemonic",value:function(e,t){var n=this;this.setState((function(a,r){return Object(o.a)({},e,Object.assign({},n.state[e],{mnemonic:t}))}))}},{key:"addStateData",value:function(e,t,n){var a=this;if(0===this.state[t].filter((function(t){return t[n]===e[n]})).length){var r=this.state[t].concat([e]);this.setState((function(e){var n=a.getStorage();return n[t]=r,a.setStorage(n),Object(o.a)({},t,r)}))}}},{key:"removeStateData",value:function(e,t,n){var a=this,r=this.state[e].filter((function(e){return e[t]===n}));if(0!==r.length){var i=this.state[e].slice(),s=this.state[e].indexOf(r[0]);i.splice(s,1),this.setState((function(t){var n=a.getStorage();return n[e]=i,a.setStorage(n),Object(o.a)({},e,i)}))}}},{key:"addTx",value:function(e){this.addStateData(e,"txs","id")}},{key:"removeTx",value:function(e){this.removeStateData("txs","id",e)}},{key:"addIntermediate",value:function(e){this.addStateData(e,"intermediate","address")}},{key:"removeIntermediate",value:function(e){this.removeStateData("intermediate","address",e)}},{key:"render",value:function(){return r.a.createElement("div",{className:"ui container"},r.a.createElement("p",null),r.a.createElement("h2",{className:"ui header center aligned"},"Safe Bitcoin inheritance"),r.a.createElement("div",{className:"ui four column doubling stackable grid container"},r.a.createElement("div",{className:"column"},r.a.createElement(y,{mnemonic:this.state.owner.mnemonic,person:"owner",updateMnemonic:this.updateMnemonic,actions:{addTx:this.addTx}})),r.a.createElement("div",{className:"column"},r.a.createElement(j,{txs:this.state.txs,removeTx:this.removeTx,addIntermediate:this.addIntermediate})),r.a.createElement("div",{className:"column"},r.a.createElement(T,{addressesData:this.state.intermediate,actions:{sendToOwner:this.removeIntermediate,sendToHeir:this.removeIntermediate}})),r.a.createElement("div",{className:"column"},r.a.createElement(y,{mnemonic:this.state.heir.mnemonic,person:"heir",updateMnemonic:this.updateMnemonic,actions:{}}))))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},3:function(e,t,n){"use strict";var a=n(5),r={network:a.networks.testnet,apiURIs:{address:"https://api.blockchair.com/bitcoin/testnet/dashboards/address",pushTx:"https://api.blockchair.com/bitcoin/testnet/push/transaction"},owner:{name:"Alice (owner)",mnemonic:"assist drama typical garbage artwork devote expect invest theme speed surge you",derivationPath:"m/44'/1'/0'/0/0"},heir:{name:"Bob (heir)",mnemonic:"boat ecology top asthma second zero brush episode consider select noble unaware",derivationPath:"m/44'/1'/0'/0/0"},sequenceFeed:{blocks:6},fee:1e4};t.a=r},7:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return b})),n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return x})),n.d(t,"c",(function(){return k})),n.d(t,"f",(function(){return E})),n.d(t,"a",(function(){return O}));var a=n(33),r=n.n(a),i=n(44),s=n(5),o=n(68),c=n(112),d=n(69),u=n.n(d),l=n(3),m=n(31),p=n.n(m),h=n(45),v=n.n(h);function b(e,t,n){var a=c.mnemonicToSeedSync(e),r=o.fromSeed(a).derivePath(t);return{child:r,address:s.payments.p2pkh({pubkey:r.publicKey,network:n}).address,publicKey:r.publicKey}}function f(e){var t=e.childOwner,n=e.childHeir,a=e.txid,r=e.output,i=e.amount,o=e.fee,c=e.sequenceFeed,d=e.network,m=function(e,t,n){var a=s.script.number.encode(n).toString("hex"),r=e.pubkey.toString("hex"),i=t.pubkey.toString("hex");return s.script.fromASM("\n      OP_IF\n        ".concat(r,"\n        OP_CHECKSIG\n      OP_ELSE\n        ").concat(a,"\n        OP_CHECKSEQUENCEVERIFY\n        OP_DROP\n        ").concat(i,"\n        OP_CHECKSIG\n      OP_ENDIF\n    ").trim().replace(/\s+/g," "))}(s.payments.p2pkh({pubkey:t.publicKey,network:d}),s.payments.p2pkh({pubkey:n.publicKey,network:d}),u.a.encode(c)),p=s.payments.p2sh({redeem:{output:m},network:l.a.network}),h=new s.TransactionBuilder(d);h.addInput(a,r),h.addOutput(p.address,i-o);var v=s.ECPair.fromPrivateKey(t.privateKey,{compressed:!0,network:d});h.sign(0,v);var b=h.build();return{raw:b.toHex(),id:b.getId(),redeem:m.toString("hex"),lockFeed:c,address:p.address}}function x(e){return w(!0,e)}function k(e){return w(!1,e)}function w(t,n){var a=n.childPerson,r=n.redeemScript,i=n.txid,o=n.output,c=n.amount,d=n.fee,l=n.network,m=n.sequenceFeed,p=s.payments.p2sh({redeem:{output:r},network:l}),h=s.payments.p2pkh({pubkey:a.publicKey,network:l}),v=new s.Transaction;v.version=2,t?v.addInput(e.from(i,"hex").reverse(),o):v.addInput(e.from(i,"hex").reverse(),o,u.a.encode(m)),v.addOutput(s.address.toOutputScript(h.address,l),c-d);var b=v.hashForSignature(0,p.redeem.output,s.Transaction.SIGHASH_ALL),f=s.ECPair.fromPrivateKey(a.privateKey,{compressed:!0,network:l}),x=t?s.opcodes.OP_TRUE:s.opcodes.OP_0,k=s.payments.p2sh({network:l,redeem:{network:l,output:p.redeem.output,input:s.script.compile([s.script.signature.encode(f.sign(b),s.Transaction.SIGHASH_ALL),x])}}).input;return v.setInputScript(0,k),v}function E(e){var t,n=!1;try{t=(n=21===p.a.decode(e).length)?"":"Wrong address length"}catch(a){t="Error decoding base58check: "+a.message}return{isValid:n,message:t}}function O(e){return y.apply(this,arguments)}function y(){return(y=Object(i.a)(r.a.mark((function e(t){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.a.apiURIs.pushTx,e.next=3,v.a.post(n,{data:t},{headers:{"Content-Type":"application/json;charset=UTF-8"}}).catch((function(e){return alert("Blockchain API request error: "+e)}));case 3:(a=e.sent)&&alert("Broadcasted with message: "+JSON.stringify(a));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}).call(this,n(1).Buffer)}},[[113,1,2]]]);
//# sourceMappingURL=main.8900d385.chunk.js.map